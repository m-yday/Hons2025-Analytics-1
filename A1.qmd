---
title: "Analytics"
subtitle: "Assignment 1"
authors:
  - name: Victoria Dingle
  - name: Shvet Maharaj
format: html
date: last-modified
execute:
  echo: false
  warning: false
  message: false
---

```{r}
#| label: "Libraries and data"
#| output: false

library(tidyverse)
library(futureverse)
library(glmnet)
library(glmnetUtils)
train_data <- read.csv("online_shopping_train.csv", header = TRUE)

```

# Introduction

# Categorical variables
In our dataset we have some numerical variables and some categorical variables.
Our numerical variables are `Administrative`, `Administrative duration`, `Informational`, `Informational duration`, `Product related`, `Product related duration`, `Bounce rates`, `Exit rates`, `Page values` and `Special day`.
We have a number of categorical variables which will need to be converted into factors before any regression analysis can be applied to the dataset. These include `Month`, `OperatingSystems`, `Browser`, `VisitorType`, `Weekend`, and `Revenue` (our target variable). We will convert our categorical variables (except `Revenue`) into factors.

```{r}
#| label: "Categorical to factors"
#| output: hide

train_data <- train_data |> 
  mutate(
    Month = as.factor(Month), 
    OperatingSystems = as.factor(OperatingSystems), 
    Browser = as.factor(Browser), 
    VisitorType = as.factor(VisitorType), 
    Weekend = as.factor(Weekend))
```

We want to fit a linear regression model to our data. We begin with a saturated model.

```{r}
#| label: "Saturated model"

lm_full <- glm(Revenue ~ ., train_data, family=binomial)
lm_full %>% # tidy() %>%
  kable(digits=2, caption="Saturated linear model of the online shopping data") #Fix this...
```
We now regularise this model using elasticnet regression.
```{r}
#| label: "Elastic net regularisation"

elasticnet <- cva.glmnet(Revenue ~., train_data, alpha = seq(0, 1, 0.1), nfolds=10, family=binomial) # Fix
plot(elasticnet)

# df1 <- as.data.frame(matrix(cbind(coef(elasticnet, alpha=0), coef(elasticnet, alpha=0.1), coef(elasticnet, alpha=0.2), coef(elasticnet, alpha=0.3), coef(elasticnet, alpha=0.4), coef(elasticnet, alpha=0.5), coef(elasticnet, alpha=0.6), coef(elasticnet, alpha=0.7), coef(elasticnet, alpha=0.8), coef(elasticnet, alpha=0.9), coef(elasticnet, alpha=1)), ncol=11))
# colnames(df1) <- c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1)

kable(df1, digits=3)
```

We choose something here, and we motivate it. In fact, that's pretty important. Please don't forget! (Especially because leaving this paragraph in will be awkward...)

Next, we use 
